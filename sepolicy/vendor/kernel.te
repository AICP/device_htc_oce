# Allow access to sysfs
allow kernel sysfs:file rw_file_perms;
allow kernel self:capability dac_override;
allow kernel vfat:dir r_dir_perms;
allow kernel vfat:file r_file_perms;

allow kernel self:security setenforce;

r_dir_file(kernel, firmware_file)

# for diag over socket
userdebug_or_eng(`
  allow kernel self:socket create;
')
dontaudit kernel self:socket create;
