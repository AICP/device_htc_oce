allow init device:chr_file getattr;
allow init diag_device:chr_file getattr;
allow init functionfs:dir mounton;
allow init hwservicemanager:binder { call transfer };
allow init hal_light_hwservice:hwservice_manager add;
allow init hal_power_hwservice:hwservice_manager add;
allow init hal_thermal_hwservice:hwservice_manager add;
allow init hidl_base_hwservice:hwservice_manager add;
allow init proc:file setattr;
allow init property_socket:sock_file write;
allow init shell_exec:file execute_no_trans;
allow init sysfs_devfreq:file { open read };
allow init sysfs_devices_system_cpu:file { read open setattr getattr write };
allow init sysfs:dir { read open setattr getattr write };
allow init sysfs:file { read open setattr getattr write };
allow init sysfs_graphics:file { open write };
allow init sysfs_kgsl:file { open read };
allow init sysfs_lib:file { read open setattr getattr write };
allow init sysfs_lowmemorykiller:file { read open setattr getattr write };
allow init sysfs_msm_power:file { read open setattr getattr write };
allow init sysfs_vmpressure:file { read open setattr getattr write };
allow init system_data_file:file append;
allow init system_file:file execute_no_trans;
allow init vendor_file:file execute_no_trans;
allow init vendor_toolbox_exec:file execute_no_trans;

allow init tmpfs:lnk_file create_file_perms;

# vold and cryptd
allow init socket_device:sock_file { create setattr unlink write };
# usb
allow init sysfs_usb:file { setattr };
# bluetooth
allow init sysfs_bluetooth_writable:file { setattr read };
# cpu
allow init sysfs_thermal:file setattr;
# wlan firmware
allow init sysfs_wlan_fwpath:file { read open write getattr setattr open };

allow init ion_device:chr_file ioctl;
allow init proc:file { getattr open setattr read };
allow init property_socket:sock_file write;
# noatsecure party time
allow init cameraserver:process noatsecure;
allow init adbd:process noatsecure;
allow init audioserver:process noatsecure;
allow init fsck:process noatsecure;
allow init mediaserver:process noatsecure;
allow init recovery_refresh:process noatsecure;
allow init tee:process noatsecure;
allow init ueventd:process noatsecure;
allow init vendor_init:process noatsecure;
allow init vold:process noatsecure;
allow init bootanim:process noatsecure;
allow init healthd:process noatsecure;
allow init hwservicemanager:process noatsecure;
allow init netd:process noatsecure;
allow init recovery_persist:process noatsecure;
allow init rild:process noatsecure;
allow init servicemanager:process noatsecure;
allow init tzdatacheck:process noatsecure;
allow init update_verifier:process noatsecure;
allow init vdc:process noatsecure;
allow init vndservicemanager:process noatsecure;
allow init zygote:process noatsecure;
allow init netmgrd:process noatsecure;
allow init otapreopt_slot:process noatsecure;
allow init drmserver:process noatsecure;
allow init installd:process noatsecure;
allow init mediacodec:process noatsecure;
allow init mediadrmserver:process noatsecure;
allow init mediaextractor:process noatsecure;
allow init wificond:process noatsecure;
allow init keystore:process noatsecure;
allow init bootstat:process noatsecure;
allow init hal_bluetooth_default:process noatsecure;
allow init hal_cas_default:process noatsecure;
allow init hal_imsrtp:process noatsecure;
allow init hal_keymaster_default:process noatsecure;
allow init hal_wifi_supplicant_default:process noatsecure;
allow init kernel:system module_request;
allow init location:process noatsecure;
allow init logd:process noatsecure;
allow init mediametrics:process noatsecure;
allow init mm-pp-daemon:process noatsecure;
allow init qti_init_shell:process noatsecure;
allow init time_daemon:process noatsecure;
allow init toolbox:process noatsecure;
allow init vendor_modprobe:process noatsecure;
allow init hal_audio_default:process noatsecure;
allow init hal_camera_default:process noatsecure;
allow init hal_configstore_default:process noatsecure;
allow init hal_drm_default:process noatsecure;
allow init ims:process noatsecure;
allow init atfwd:process noatsecure;
allow init hal_drm_clearkey:process noatsecure;
allow init hal_drm_widevine:process noatsecure;
allow init hal_gatekeeper_default:process noatsecure;
allow init hal_health_default:process noatsecure;
allow init ipacm:process noatsecure;
allow init mm-qcamerad:process noatsecure;
allow init dpmd:process noatsecure;
allow init gatekeeperd:process noatsecure;
allow init hal_gnss_qti:process noatsecure;
allow init hal_graphics_allocator_default:process noatsecure;
allow init hal_graphics_composer_default:process noatsecure;
allow init hal_memtrack_default:process noatsecure;
allow init hal_nfc_default:process noatsecure;
allow init hal_usb_default:process noatsecure;
allow init usbd:process noatsecure;
allow init vendor_per_mgr:process noatsecure;
allow init thermal-engine:process noatsecure;
allow init tombstoned:process noatsecure;
allow init hal_display_color_default:process noatsecure;
allow init hal_fingerprint_default:process noatsecure;
allow init hal_sensors_default:process noatsecure;
allow init hal_vibrator_default:process noatsecure;
allow init hal_wifi_default:process noatsecure;
allow init perfprofd:process noatsecure;
allow init hal_alarm_qti_default:process noatsecure;
allow init hal_qteeconnector_qti:process noatsecure;
allow init irsc_util:process noatsecure;
allow init msm_irqbalanced:process noatsecure;
allow init lmkd:process noatsecure;
allow init rfs_access:process noatsecure;
allow init rmt_storage:process noatsecure;
allow init surfaceflinger:process noatsecure;
allow init thermalserviced:process noatsecure;
allow init adsprpcd:process noatsecure;
allow init cnd:process noatsecure;
allow init hal_dpmQmiMgr:process noatsecure;
allow init qti:process noatsecure;
allow init hvdcp:process noatsecure;
allow init incidentd:process noatsecure;

allow init vfat:dir search;

allow init self:process execmem;
